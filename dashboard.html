<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Dashboard Carine Merlot | Crédit Agricole</title>
  <meta name="description" content="Dashboard bancaire personnel - Crédit Agricole">
  <meta name="theme-color" content="#047857">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { 'inter': ['Inter', 'system-ui', 'sans-serif'] },
          colors: {
            'ca-green': { 50: '#f0fdf4', 100: '#dcfce7', 500: '#047857', 600: '#065f46', 700: '#064e3b', 800: '#052e16' },
            'ca-gray': { 50: '#fafafa', 100: '#f5f5f5', 400: '#9ca3af', 500: '#6b7280', 600: '#4b5563', 700: '#374151', 800: '#1f2937', 900: '#111827' }
          },
          animation: {
            'fade-in': 'fadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1)',
            'slide-up': 'slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)',
            'scale-in': 'scaleIn 0.2s cubic-bezier(0.4, 0, 0.2, 1)',
            'bounce-subtle': 'bounceSubtle 0.6s cubic-bezier(0.4, 0, 0.2, 1)',
            'card-flip': 'cardFlip 0.8s cubic-bezier(0.4, 0, 0.2, 1)',
            'pulse-glow': 'pulseGlow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'shake': 'shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97)',
            'slide-down': 'slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1)'
          }
        }
      }
    }
  </script>
  <style>
    * { box-sizing: border-box; }
    body { font-family: 'Inter', system-ui, -apple-system, sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    
    /* Custom Scrollbar */
    .custom-scrollbar::-webkit-scrollbar { width: 4px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 2px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    
    /* Hide scrollbar but keep functionality */
    .scrollbar-hidden { -ms-overflow-style: none; scrollbar-width: none; }
    .scrollbar-hidden::-webkit-scrollbar { display: none; }
    
    /* Custom animations */
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes scaleIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    @keyframes bounceSubtle { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }
    @keyframes cardFlip { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(180deg); } }
    @keyframes pulseGlow { 0%, 100% { opacity: 1; box-shadow: 0 0 5px rgba(239, 68, 68, 0.5); } 50% { opacity: 0.8; box-shadow: 0 0 15px rgba(239, 68, 68, 0.8); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); } 20%, 40%, 60%, 80% { transform: translateX(2px); } }
    
    /* Enhanced card styles */
    .account-card {
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      border: 1px solid rgba(148, 163, 184, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    
    .account-card.active:hover {
      transform: translateY(-6px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(4, 120, 87, 0.1);
      border-color: rgba(4, 120, 87, 0.2);
      cursor: pointer;
    }
    
    .account-card.blocked {
      background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
      border: 2px solid #fca5a5;
      opacity: 0.8;
      cursor: not-allowed;
      position: relative;
    }
    
    .account-card.blocked::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 10px,
        rgba(220, 38, 38, 0.1) 10px,
        rgba(220, 38, 38, 0.1) 20px
      );
      pointer-events: none;
      border-radius: inherit;
    }
    
    .account-card.blocked:hover {
      animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97);
      transform: none;
      box-shadow: 0 8px 25px rgba(220, 38, 38, 0.2);
    }
    
    .account-card.low-balance {
      background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
      border: 1px solid #f59e0b;
    }
    
    /* Account status indicators */
    .status-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    
    .status-active { background: #10b981; box-shadow: 0 0 6px rgba(16, 185, 129, 0.4); }
    .status-blocked { background: #ef4444; box-shadow: 0 0 6px rgba(239, 68, 68, 0.6); animation: pulse 2s infinite; }
    .status-warning { background: #f59e0b; box-shadow: 0 0 6px rgba(245, 158, 11, 0.4); }
    
    /* Account layout improvements */
    .account-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
    }
    
    .account-info {
      flex: 1;
      min-width: 0;
    }
    
    .account-balance {
      flex-shrink: 0;
      text-align: right;
      min-width: 120px;
    }
    
    .account-name {
      font-size: 1.125rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 4px;
      line-height: 1.3;
    }
    
    .account-iban {
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
      color: #6b7280;
      letter-spacing: 0.05em;
      margin-bottom: 2px;
    }
    
    .account-amount {
      font-size: 1.5rem;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 4px;
    }
    
    .account-variation {
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .blocked-overlay {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #dc2626;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.625rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);
    }
    
    /* Settings dropdown */
    .settings-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(0, 0, 0, 0.05);
      min-width: 200px;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.2s ease;
    }
    
    .settings-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .settings-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      color: #374151;
      text-decoration: none;
      transition: all 0.2s ease;
      font-size: 0.875rem;
      border-bottom: 1px solid #f3f4f6;
    }
    
    .settings-item:last-child {
      border-bottom: none;
    }
    
    .settings-item:hover {
      background: #f9fafb;
      color: #047857;
    }
    
    .settings-item.danger {
      color: #dc2626;
    }
    
    .settings-item.danger:hover {
      background: #fef2f2;
      color: #dc2626;
    }
    
    .settings-item svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }
    
    /* Header buttons */
    .header-btn {
      position: relative;
      padding: 12px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .header-btn:hover {
      background: rgba(255, 255, 255, 0.95);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    }
    
    /* Credit card container */
    .credit-card-container {
      perspective: 1200px;
      width: 100%;
      max-width: 380px;
      margin: 0 auto;
      cursor: pointer;
      user-select: none;
    }
    
    .credit-card {
      width: 100%;
      height: 240px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      border-radius: 16px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15), 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .credit-card.flipped { transform: rotateY(180deg); }
    
    .credit-card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 16px;
      overflow: hidden;
      padding: 24px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    
    .credit-card-front {
      background: linear-gradient(135deg, #047857 0%, #065f46 50%, #064e3b 100%);
      color: white;
      position: relative;
    }
    
    .credit-card-front::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.05"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
      opacity: 0.3;
      pointer-events: none;
    }
    
    .credit-card-back {
      background: linear-gradient(135deg, #064e3b 0%, #052e16 100%);
      transform: rotateY(180deg);
      color: #d1d5db;
    }
    
    .chip {
      width: 52px;
      height: 38px;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
      border-radius: 8px;
      position: relative;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .chip::before {
      content: '';
      position: absolute;
      width: 14px;
      height: 14px;
      background: #fde047;
      border-radius: 50%;
      top: 6px;
      left: 6px;
    }
    
    .chip::after {
      content: '';
      position: absolute;
      width: 14px;
      height: 14px;
      background: #fde047;
      border-radius: 50%;
      top: 6px;
      right: 6px;
    }
    
    .card-number {
      font-family: 'Courier New', monospace;
      font-size: 1.5rem;
      font-weight: 500;
      letter-spacing: 0.25em;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .card-info {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 500;
    }
    
    /* Enhanced transaction styles */
    .transaction-item {
      display: grid;
      grid-template-columns: 80px 1fr auto;
      gap: 16px;
      padding: 16px;
      border-radius: 12px;
      transition: all 0.2s ease;
      cursor: pointer;
      border: 1px solid transparent;
    }
    
    .transaction-item:hover {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-color: rgba(4, 120, 87, 0.1);
      transform: translateX(4px);
    }
    
    .transaction-date {
      font-size: 0.75rem;
      color: #6b7280;
      font-weight: 500;
      display: flex;
      align-items: center;
    }
    
    .transaction-desc {
      color: #374151;
      font-weight: 500;
      display: flex;
      align-items: center;
    }
    
    .transaction-amount {
      font-weight: 700;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: flex-end;
    }
    
    .amount-positive { color: #059669; }
    .amount-negative { color: #dc2626; }
    
    /* Enhanced modal styles */
    .modal-overlay {
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      transition: all 0.3s ease;
    }
    
    .modal-content {
      background: white;
      border-radius: 20px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.95);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .modal-content.show { transform: scale(1); }
    
    /* Enhanced form styles */
    .form-group {
      position: relative;
      margin-bottom: 20px;
    }
    
    .form-input {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.2s ease;
      background: #fafafa;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #047857;
      background: white;
      box-shadow: 0 0 0 3px rgba(4, 120, 87, 0.1);
    }
    
    .form-label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: #374151;
      font-size: 0.875rem;
    }
    
    /* Enhanced button styles */
    .btn-primary {
      background: linear-gradient(135deg, #047857 0%, #065f46 100%);
      color: white;
      font-weight: 600;
      padding: 14px 24px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 14px rgba(4, 120, 87, 0.3);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(4, 120, 87, 0.4);
    }
    
    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(4, 120, 87, 0.3);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      color: white;
      font-weight: 600;
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 14px rgba(220, 38, 38, 0.3);
    }
    
    .btn-danger:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4);
    }
    
    .btn-secondary {
      background: #f3f4f6;
      color: #374151;
      font-weight: 600;
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .btn-secondary:hover {
      background: #e5e7eb;
      transform: translateY(-1px);
    }
    
    /* Enhanced navigation */
    .bottom-nav {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-top: 1px solid rgba(0, 0, 0, 0.05);
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.1);
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px 12px;
      color: #6b7280;
      transition: all 0.2s ease;
      border-radius: 12px;
      margin: 4px;
    }
    
    .nav-item:hover,
    .nav-item.active {
      color: #047857;
      background: rgba(4, 120, 87, 0.1);
      transform: translateY(-2px);
    }
    
    .nav-item svg {
      width: 24px;
      height: 24px;
      margin-bottom: 4px;
      transition: transform 0.2s ease;
    }
    
    .nav-item:hover svg {
      transform: scale(1.1);
    }
    
    /* Enhanced notification badge */
    .notification-badge {
      background: #ef4444;
      animation: pulseGlow 2s infinite;
    }
    
    /* Responsive enhancements */
    @media (max-width: 400px) {
      .credit-card { height: 200px; }
      .card-number { font-size: 1.25rem; }
      .transaction-item { grid-template-columns: 70px 1fr auto; gap: 12px; padding: 12px; }
      .account-header { gap: 12px; }
      .account-amount { font-size: 1.25rem; }
      .settings-dropdown { right: -20px; min-width: 180px; }
    }
  </style>
</head>

<body class="bg-gradient-to-br from-teal-50 via-emerald-50 to-green-50 min-h-screen text-ca-gray-900">
  <div class="max-w-md mx-auto p-4 pt-safe-top relative pb-24">
    
    <!-- Enhanced Header with Settings -->
    <header class="flex justify-between items-center mb-8 animate-fade-in">
      <div>
        <h1 class="text-3xl font-bold text-ca-gray-800 mb-1">Bonjour, Carine</h1>
        <p class="text-sm text-ca-gray-500" id="currentDateTime"></p>
      </div>
      
      <div class="flex items-center gap-3">
        <!-- Notifications Button -->
        <button id="notificationBtn" 
                class="header-btn focus:outline-none focus:ring-2 focus:ring-ca-green-500"
                aria-label="Notifications (2 nouvelles)">
          <svg class="w-5 h-5 text-ca-green-700" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"/>
          </svg>
          <span class="notification-badge absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-semibold">2</span>
        </button>

        <!-- Settings Button -->
        <div class="relative">
          <button id="settingsBtn" 
                  class="header-btn focus:outline-none focus:ring-2 focus:ring-ca-green-500"
                  aria-label="Paramètres et options"
                  onclick="toggleSettingsDropdown()">
            <svg class="w-5 h-5 text-ca-green-700" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"/>
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
          </button>

          <!-- Settings Dropdown -->
          <div id="settingsDropdown" class="settings-dropdown">
            <a href="#" class="settings-item" onclick="showProfile()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
              </svg>
              Mon profil
            </a>
            
            <a href="#" class="settings-item" onclick="showNotifications()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-9.33-5M7 17h6M10 21h4a2 2 0 01-4 0z"/>
              </svg>
              Notifications
            </a>
            
            <a href="#" class="settings-item" onclick="showSecurity()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
              </svg>
              Sécurité
            </a>
            
            <a href="#" class="settings-item" onclick="showHelp()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              Aide & Support
            </a>
            
            <div style="border-top: 1px solid #e5e7eb; margin: 8px 0;"></div>
            
            <a href="#" class="settings-item danger" onclick="confirmLogout()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
              </svg>
              Se déconnecter
            </a>
          </div>
        </div>
      </div>
    </header>

    <!-- Enhanced Tab Navigation -->
    <nav class="flex space-x-1 mb-8 bg-white/60 backdrop-blur-sm rounded-2xl p-1 animate-slide-up" 
         role="tablist" aria-label="Navigation principale">
      <button class="tab-btn flex-1 py-3 px-4 text-sm font-semibold rounded-xl transition-all duration-200 text-white bg-ca-green-600 shadow-lg"
              role="tab" aria-selected="true" data-tab="0">Comptes</button>
      <button class="tab-btn flex-1 py-3 px-4 text-sm font-semibold rounded-xl transition-all duration-200 text-ca-gray-600 hover:text-ca-green-600 hover:bg-white/50"
              role="tab" data-tab="1">Épargne</button>
      <button class="tab-btn flex-1 py-3 px-4 text-sm font-semibold rounded-xl transition-all duration-200 text-ca-gray-600 hover:text-ca-green-600 hover:bg-white/50"
              role="tab" data-tab="2">Crédits</button>
      <button class="tab-btn flex-1 py-3 px-4 text-sm font-semibold rounded-xl transition-all duration-200 text-ca-gray-600 hover:text-ca-green-600 hover:bg-white/50"
              role="tab" data-tab="3">Assurances</button>
    </nav>

    <!-- Enhanced Tab Content -->
    <div id="tabContent" class="mb-8">
      <!-- Comptes Tab -->
      <section class="tab-panel space-y-4" data-panel="0" aria-labelledby="tab-comptes">
        
        <!-- Compte Courant - Solde très bas -->
        <article class="account-card low-balance rounded-2xl p-6 will-change-transform active" 
                 onclick="openTransferModal('Compte courant', 'FR763000200515000000000123', 2.00)"
                 role="button" tabindex="0" aria-label="Compte courant, solde 2 euros">
          <div class="account-header">
            <div class="account-info">
              <h3 class="account-name">Compte courant</h3>
              <p class="account-iban">FR76 3000 2005 1500 0000 0000 123</p>
              <div class="status-indicator">
                <div class="status-dot status-warning"></div>
                <span class="text-amber-700">Solde insuffisant</span>
              </div>
            </div>
            <div class="account-balance">
              <div class="account-amount text-amber-600">2,00 €</div>
              <div class="account-variation text-red-500">-2 348,00 € ce mois</div>
            </div>
          </div>
        </article>

        <!-- Compte Bloqué - Non fonctionnel -->
        <article class="account-card blocked rounded-2xl p-6 will-change-transform" 
                 onclick="showBlockedAccountInfo()"
                 role="button" tabindex="0" aria-label="Compte bloqué, accès suspendu">
          <div class="blocked-overlay">
            <svg class="w-3 h-3 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
            </svg>
            BLOQUÉ
          </div>
          <div class="account-header">
            <div class="account-info">
              <h3 class="account-name text-red-700">Compte bloqué</h3>
              <p class="account-iban">FR76 3000 2005 1500 0000 0000 456</p>
              <div class="status-indicator">
                <div class="status-dot status-blocked"></div>
                <span class="text-red-600">Suspendu depuis le 15/06/2023</span>
              </div>
            </div>
            <div class="account-balance">
              <div class="account-amount text-red-600">650 000,00 €</div>
              <div class="account-variation text-red-500">
                <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                </svg>
                Accès interdit
              </div>
            </div>
          </div>
        </article>

        <!-- Compte Professionnel - Solde très bas -->
        <article class="account-card low-balance rounded-2xl p-6 will-change-transform active" 
                 onclick="openTransferModal('Compte professionnel', 'FR763000200515000000000789', 5.00)"
                 role="button" tabindex="0" aria-label="Compte professionnel, solde 5 euros">
          <div class="account-header">
            <div class="account-info">
              <h3 class="account-name">Compte professionnel</h3>
              <p class="account-iban">FR76 3000 2005 1500 0000 0000 789</p>
              <div class="status-indicator">
                <div class="status-dot status-warning"></div>
                <span class="text-amber-700">Solde critique</span>
              </div>
            </div>
            <div class="account-balance">
              <div class="account-amount text-amber-600">5,00 €</div>
              <div class="account-variation text-red-500">-15 675,00 € ce mois</div>
            </div>
          </div>
        </article>

      </section>

      <!-- Other tabs content -->
      <section class="tab-panel space-y-4 hidden" data-panel="1">
        <div class="account-card rounded-2xl p-6">
          <h3 class="text-lg font-semibold mb-4">Comptes d'épargne</h3>
          <p class="text-ca-gray-500">Aucun compte d'épargne disponible</p>
        </div>
      </section>

      <section class="tab-panel space-y-4 hidden" data-panel="2">
        <div class="account-card rounded-2xl p-6">
          <h3 class="text-lg font-semibold mb-4">Crédits en cours</h3>
          <p class="text-ca-gray-500">Aucun crédit en cours</p>
        </div>
      </section>

      <section class="tab-panel space-y-4 hidden" data-panel="3">
        <div class="account-card rounded-2xl p-6">
          <h3 class="text-lg font-semibold mb-4">Assurances</h3>
          <p class="text-ca-gray-500">Aucune assurance souscrite</p>
        </div>
      </section>
    </div>

    <!-- Enhanced Credit Card -->
    <section class="mb-8" aria-label="Carte de crédit">
      <div class="credit-card-container will-change-transform" 
           tabindex="0" role="button" 
           aria-label="Carte de crédit, cliquez pour voir les détails au verso"
           onclick="toggleCreditCard()" onkeydown="handleCardKeydown(event)">
        <div id="creditCard" class="credit-card will-change-transform">
          <div class="credit-card-face credit-card-front">
            <div class="flex justify-between items-start mb-6">
              <div class="chip"></div>
              <div class="text-right">
                <div class="text-xs opacity-80 mb-1">REVOLUT</div>
                <div class="w-8 h-8 bg-white/20 rounded backdrop-blur-sm flex items-center justify-center">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2L2 7v10c0 5.55 3.84 9.739 9 11 5.16-1.261 9-5.45 9-11V7l-10-5z"/>
                  </svg>
                </div>
              </div>
            </div>
            
            <div class="card-number mb-6">**** **** **** 1234</div>
            
            <div class="card-info">
              <div>
                <div class="text-xs opacity-70 mb-1">TITULAIRE</div>
                <div class="font-semibold">CARINE MERLOT</div>
              </div>
              <div class="text-right">
                <div class="text-xs opacity-70 mb-1">EXPIRE FIN</div>
                <div class="font-semibold">12/26</div>
              </div>
            </div>
          </div>
          
          <div class="credit-card-face credit-card-back">
            <div class="w-full h-10 bg-black rounded mb-4 mt-4"></div>
            <div class="bg-white/90 h-8 rounded mb-4 flex items-center justify-between px-3">
              <span class="text-black text-sm font-semibold">Carine Merlot</span>
              <span class="bg-white text-black px-2 py-1 rounded text-sm font-bold">123</span>
            </div>
            <div class="text-center text-xs opacity-70">
              <p>En cas de perte ou vol : 09 69 39 92 91</p>
              <p class="mt-2">REVOLUT - Carte Professionnelle</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Enhanced Transaction History -->
    <section class="account-card rounded-2xl p-6 mb-8" aria-label="Historique des transactions">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-bold text-ca-gray-800">Dernières transactions</h2>
        <button class="text-ca-green-600 text-sm font-semibold hover:text-ca-green-700 transition-colors">
          Voir tout
        </button>
      </div>
      
      <div class="space-y-1 max-h-80 overflow-y-auto custom-scrollbar" id="transactionsList">
        <div class="transaction-item" onclick="showTransactionDetail('tx-001')">
          <div class="transaction-date">15/06</div>
          <div class="transaction-desc">
            <div>
              <div class="font-medium">Virement reçu</div>
              <div class="text-xs text-ca-gray-500">Monsieur Dupont</div>
            </div>
          </div>
          <div class="transaction-amount amount-positive">+1 200,00 €</div>
        </div>
        
        <div class="transaction-item" onclick="showTransactionDetail('tx-002')">
          <div class="transaction-date">14/06</div>
          <div class="transaction-desc">
            <div>
              <div class="font-medium">Prélèvement</div>
              <div class="text-xs text-ca-gray-500">URSSAF</div>
            </div>
          </div>
          <div class="transaction-amount amount-negative">-1 190,00 €</div>
        </div>
        
        <div class="transaction-item" onclick="showTransactionDetail('tx-003')">
          <div class="transaction-date">13/06</div>
          <div class="transaction-desc">
            <div>
              <div class="font-medium">Retrait DAB</div>
              <div class="text-xs text-ca-gray-500">Solde insuffisant</div>
            </div>
          </div>
          <div class="transaction-amount text-red-600">REFUSÉ</div>
        </div>

        <div class="transaction-item" onclick="showTransactionDetail('tx-004')">
          <div class="transaction-date">10/06</div>
          <div class="transaction-desc">
            <div>
              <div class="font-medium">Frais de découvert</div>
              <div class="text-xs text-ca-gray-500">Agios</div>
            </div>
          </div>
          <div class="transaction-amount amount-negative">-45,00 €</div>
        </div>
      </div>
    </section>
  </div>

  <!-- Enhanced Transfer Modal -->
  <div id="transferModal" class="fixed inset-0 modal-overlay flex items-center justify-center z-50 hidden will-change-opacity" 
       role="dialog" aria-modal="true" aria-labelledby="transferModalTitle">
    <div class="modal-content w-full max-w-md mx-4 p-6" onclick="event.stopPropagation()">
      <div class="flex justify-between items-center mb-6">
        <h2 id="transferModalTitle" class="text-2xl font-bold text-ca-gray-800">Nouveau virement</h2>
        <button onclick="closeTransferModal()" 
                class="p-2 rounded-full hover:bg-ca-gray-100 transition-colors"
                aria-label="Fermer">
          <svg class="w-6 h-6 text-ca-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <form id="transferForm" class="space-y-6" onsubmit="handleTransferSubmit(event)">
        <div class="form-group">
          <label for="sourceAccount" class="form-label">Compte débiteur</label>
          <select id="sourceAccount" class="form-input" required>
            <option value="">Sélectionnez un compte</option>
            <option value="courant">Compte courant (2,00 €) ⚠️</option>
            <option value="pro">Compte professionnel (5,00 €) ⚠️</option>
          </select>
          <p class="text-xs text-amber-600 mt-1">⚠️ Soldes insuffisants - Virements limités</p>
        </div>

        <div class="form-group">
          <label for="beneficiary" class="form-label">Bénéficiaire</label>
          <select id="beneficiary" class="form-input" required onchange="updateBeneficiaryIban()">
            <option value="">Sélectionnez un bénéficiaire</option>
            <option value="jean">Jean Dupont</option>
            <option value="marie">Marie Lambert</option>
            <option value="paul">Paul Martin</option>
            <option value="new">Nouveau bénéficiaire...</option>
          </select>
        </div>

        <div class="form-group">
          <label for="iban" class="form-label">IBAN</label>
          <input id="iban" type="text" class="form-input" 
                 placeholder="FR76 3000 1000 1234 5678 9000 123"
                 maxlength="34" required oninput="formatIban(this)">
        </div>

        <div class="form-group">
          <label for="amount" class="form-label">Montant</label>
          <div class="relative">
            <input id="amount" type="text" class="form-input pl-8" 
                   placeholder="0,00" required oninput="validateAmount(this)">
            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-ca-gray-500">€</span>
          </div>
          <div id="amountError" class="hidden text-red-500 text-sm mt-1"></div>
          <p class="text-xs text-amber-600 mt-1">⚠️ Montant maximum selon solde disponible</p>
        </div>

        <div class="form-group">
          <label for="reference" class="form-label">Référence (optionnel)</label>
          <input id="reference" type="text" class="form-input" 
                 placeholder="Libellé du virement" maxlength="140">
        </div>

        <button type="submit" class="btn-primary w-full">
          <span class="flex items-center justify-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
            </svg>
            Envoyer le virement
          </span>
        </button>
      </form>
    </div>
  </div>

  <!-- Blocked Account Modal -->
  <div id="blockedModal" class="fixed inset-0 modal-overlay flex items-center justify-center z-50 hidden will-change-opacity" 
       role="dialog" aria-modal="true">
    <div class="modal-content w-full max-w-md mx-4 p-6" onclick="event.stopPropagation()">
      <div class="text-center">
        <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4">
          <svg class="h-8 w-8 text-red-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
          </svg>
        </div>
        <h3 class="text-xl leading-6 font-bold text-red-700 mb-4">Compte Suspendu</h3>
        <div class="text-left bg-red-50 p-4 rounded-lg mb-6">
          <p class="text-sm text-red-800 mb-2"><strong>Raison :</strong> Activité suspecte détectée</p>
          <p class="text-sm text-red-800 mb-2"><strong>Date :</strong> 15/06/2023</p>
          <p class="text-sm text-red-800 mb-2"><strong>Référence :</strong> SUSP-2023-456789</p>
          <p class="text-sm text-red-800"><strong>Solde bloqué :</strong> 650 000,00 €</p>
        </div>
        <div class="text-sm text-ca-gray-600 mb-6">
          <p class="mb-2">🔒 Toutes les opérations sont suspendues</p>
          <p class="mb-2">📞 Contactez immédiatement votre conseiller</p>
          <p>⏰ Délai de résolution : 5-10 jours ouvrés</p>
        </div>
        <div class="flex space-x-3">
          <button onclick="callAdvisor()" class="flex-1 bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition-colors text-sm font-semibold">
            📞 Appeler conseiller
          </button>
          <button onclick="closeBlockedModal()" class="flex-1 bg-ca-gray-200 text-ca-gray-800 py-3 px-4 rounded-lg hover:bg-ca-gray-300 transition-colors text-sm font-semibold">
            Fermer
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Logout Confirmation Modal -->
  <div id="logoutModal" class="fixed inset-0 modal-overlay flex items-center justify-center z-50 hidden will-change-opacity" 
       role="dialog" aria-modal="true">
    <div class="modal-content w-full max-w-sm mx-4 p-6" onclick="event.stopPropagation()">
      <div class="text-center">
        <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4">
          <svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
          </svg>
        </div>
        <h3 class="text-lg leading-6 font-bold text-ca-gray-900 mb-2">Confirmer la déconnexion</h3>
        <p class="text-sm text-ca-gray-500 mb-6">
          Êtes-vous sûr de vouloir vous déconnecter de votre session bancaire ?
        </p>
        <div class="flex space-x-3">
          <button onclick="performLogout()" class="flex-1 btn-danger">
            Se déconnecter
          </button>
          <button onclick="closeLogoutModal()" class="flex-1 btn-secondary">
            Annuler
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Bottom Navigation -->
  <nav class="bottom-nav fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md flex justify-around py-2 px-4" 
       role="navigation" aria-label="Navigation principale">
    <button class="nav-item active" onclick="switchToHome()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
      </svg>
      <span class="text-xs font-medium">Accueil</span>
    </button>
    
    <button class="nav-item" onclick="quickTransfer()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
      </svg>
      <span class="text-xs font-medium">Virements</span>
    </button>
    
    <button class="nav-item" onclick="showCards()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
      </svg>
      <span class="text-xs font-medium">Cartes</span>
    </button>
    
    <button class="nav-item" onclick="showProfile()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
      </svg>
      <span class="text-xs font-medium">Profil</span>
    </button>
  </nav>

  <!-- Enhanced JavaScript -->
  <script>
    // Enhanced Application State Management
    class BankingApp {
      constructor() {
        this.state = {
          currentTab: 0,
          isCardFlipped: false,
          isLoading: false,
          settingsOpen: false,
          accounts: {
            courant: { balance: 2.00, blocked: false, warning: true },
            bloque: { balance: 650000.00, blocked: true, warning: false },
            pro: { balance: 5.00, blocked: false, warning: true }
          },
          beneficiaries: {
            jean: { name: 'Jean Dupont', iban: 'FR76 1234 5678 9012 3456 7890 123' },
            marie: { name: 'Marie Lambert', iban: 'FR76 9876 5432 1098 7654 3210 987' },
            paul: { name: 'Paul Martin', iban: 'FR76 5555 4444 3333 2222 1111 000' }
          }
        };
        this.init();
      }

      init() {
        this.updateDateTime();
        this.bindEvents();
        this.setupIntersectionObserver();
        setInterval(() => this.updateDateTime(), 60000);
      }

      updateDateTime() {
        const now = new Date();
        const options = { 
          weekday: 'long', 
          day: 'numeric', 
          month: 'long',
          hour: '2-digit',
          minute: '2-digit'
        };
        document.getElementById('currentDateTime').textContent = 
          now.toLocaleDateString('fr-FR', options);
      }

      bindEvents() {
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach((btn, index) => {
          btn.addEventListener('click', () => this.switchTab(index));
        });

        // Modal events
        document.getElementById('transferModal').addEventListener('click', (e) => {
          if (e.target.id === 'transferModal') this.closeTransferModal();
        });

        document.getElementById('blockedModal')?.addEventListener('click', (e) => {
          if (e.target.id === 'blockedModal') this.closeBlockedModal();
        });

        document.getElementById('logoutModal')?.addEventListener('click', (e) => {
          if (e.target.id === 'logoutModal') this.closeLogoutModal();
        });

        // Click outside settings dropdown
        document.addEventListener('click', (e) => {
          if (!e.target.closest('#settingsBtn') && !e.target.closest('#settingsDropdown')) {
            this.closeSettingsDropdown();
          }
        });

        // Keyboard events
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            this.closeTransferModal();
            this.closeBlockedModal();
            this.closeLogoutModal();
            this.closeSettingsDropdown();
          }
        });
      }

      setupIntersectionObserver() {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.style.animationDelay = '0s';
              entry.target.classList.add('animate-fade-in');
            }
          });
        }, { threshold: 0.1 });

        document.querySelectorAll('.account-card').forEach(card => {
          observer.observe(card);
        });
      }

      switchTab(index) {
        this.state.currentTab = index;
        
        // Update tab buttons
        document.querySelectorAll('.tab-btn').forEach((btn, i) => {
          if (i === index) {
            btn.className = 'tab-btn flex-1 py-3 px-4 text-sm font-semibold rounded-xl transition-all duration-200 text-white bg-ca-green-600 shadow-lg';
            btn.setAttribute('aria-selected', 'true');
          } else {
            btn.className = 'tab-btn flex-1 py-3 px-4 text-sm font-semibold rounded-xl transition-all duration-200 text-ca-gray-600 hover:text-ca-green-600 hover:bg-white/50';
            btn.setAttribute('aria-selected', 'false');
          }
        });

        // Update tab panels
        document.querySelectorAll('.tab-panel').forEach((panel, i) => {
          if (i === index) {
            panel.classList.remove('hidden');
            panel.classList.add('animate-slide-up');
          } else {
            panel.classList.add('hidden');
          }
        });
      }

      toggleCreditCard() {
        this.state.isCardFlipped = !this.state.isCardFlipped;
        const card = document.getElementById('creditCard');
        card.classList.toggle('flipped', this.state.isCardFlipped);
        
        // Update aria attributes
        const container = document.querySelector('.credit-card-container');
        container.setAttribute('aria-pressed', this.state.isCardFlipped.toString());
      }

      toggleSettingsDropdown() {
        this.state.settingsOpen = !this.state.settingsOpen;
        const dropdown = document.getElementById('settingsDropdown');
        
        if (this.state.settingsOpen) {
          dropdown.classList.add('show');
        } else {
          dropdown.classList.remove('show');
        }
      }

      closeSettingsDropdown() {
        this.state.settingsOpen = false;
        const dropdown = document.getElementById('settingsDropdown');
        dropdown.classList.remove('show');
      }

      openTransferModal(accountName, iban, balance) {
        const modal = document.getElementById('transferModal');
        const content = modal.querySelector('.modal-content');
        
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        
        // Animate modal
        setTimeout(() => {
          content.classList.add('show');
        }, 10);

        // Pre-fill form
        if (iban) {
          document.getElementById('iban').value = iban;
        }
      }

      closeTransferModal() {
        const modal = document.getElementById('transferModal');
        const content = modal.querySelector('.modal-content');
        
        content.classList.remove('show');
        document.body.style.overflow = 'auto';
        
        setTimeout(() => {
          modal.classList.add('hidden');
          document.getElementById('transferForm').reset();
        }, 300);
      }

      showBlockedAccountInfo() {
        const modal = document.getElementById('blockedModal');
        const content = modal.querySelector('.modal-content');
        
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        
        setTimeout(() => {
          content.classList.add('show');
        }, 10);
      }

      closeBlockedModal() {
        const modal = document.getElementById('blockedModal');
        const content = modal.querySelector('.modal-content');
        
        content.classList.remove('show');
        document.body.style.overflow = 'auto';
        
        setTimeout(() => {
          modal.classList.add('hidden');
        }, 300);
      }

      confirmLogout() {
        this.closeSettingsDropdown();
        const modal = document.getElementById('logoutModal');
        const content = modal.querySelector('.modal-content');
        
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        
        setTimeout(() => {
          content.classList.add('show');
        }, 10);
      }

      closeLogoutModal() {
        const modal = document.getElementById('logoutModal');
        const content = modal.querySelector('.modal-content');
        
        content.classList.remove('show');
        document.body.style.overflow = 'auto';
        
        setTimeout(() => {
          modal.classList.add('hidden');
        }, 300);
      }

      performLogout() {
        this.showToast('Déconnexion en cours...', 'info');
        
        // Simulate logout process
        setTimeout(() => {
          // Clear any stored data
          sessionStorage.clear();
          localStorage.removeItem('bankingSession');
          
          // Redirect to login page or show logged out state
          document.body.innerHTML = `
            <div class="min-h-screen bg-gradient-to-br from-teal-50 via-emerald-50 to-green-50 flex items-center justify-center">
              <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-ca-green-100 mb-4">
                  <svg class="h-8 w-8 text-ca-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                </div>
                <h2 class="text-2xl font-bold text-ca-gray-800 mb-2">Déconnecté avec succès</h2>
                <p class="text-ca-gray-600 mb-6">Votre session a été fermée en toute sécurité.</p>
                <button onclick="location.reload()" class="bg-ca-green-600 text-white px-6 py-3 rounded-lg hover:bg-ca-green-700 transition-colors font-semibold">
                  Se reconnecter
                </button>
              </div>
            </div>
          `;
        }, 2000);
      }

      validateAmount(input) {
        const value = input.value.replace(/[^\d,.-]/g, '');
        const errorDiv = document.getElementById('amountError');
        const sourceAccount = document.getElementById('sourceAccount').value;
        
        if (value && !/^\d+([,.]\d{1,2})?$/.test(value)) {
          errorDiv.textContent = 'Format invalide. Utilisez le format: 123,45';
          errorDiv.classList.remove('hidden');
          return false;
        }
        
        // Check balance limits
        const amount = parseFloat(value.replace(',', '.'));
        let maxAmount = 0;
        
        if (sourceAccount === 'courant') maxAmount = 2.00;
        if (sourceAccount === 'pro') maxAmount = 5.00;
        
        if (amount > maxAmount) {
          errorDiv.textContent = `Solde insuffisant. Maximum: ${maxAmount.toFixed(2)} €`;
          errorDiv.classList.remove('hidden');
          return false;
        }
        
        errorDiv.classList.add('hidden');
        return true;
      }

      formatIban(input) {
        let value = input.value.replace(/\s/g, '').toUpperCase();
        value = value.replace(/(.{4})/g, '$1 ').trim();
        input.value = value;
      }

      updateBeneficiaryIban() {
        const select = document.getElementById('beneficiary');
        const ibanInput = document.getElementById('iban');
        const beneficiary = this.state.beneficiaries[select.value];
        
        if (beneficiary) {
          ibanInput.value = beneficiary.iban;
        } else if (select.value === 'new') {
          ibanInput.value = '';
          ibanInput.focus();
        }
      }

      handleTransferSubmit(event) {
        event.preventDefault();
        
        const form = event.target;
        const formData = new FormData(form);
        
        if (!this.validateTransferForm(form)) {
          return;
        }

        this.showLoading();
        
        // Simulate API call with potential rejection
        setTimeout(() => {
          this.hideLoading();
          const amount = parseFloat(formData.get('amount').replace(',', '.'));
          const sourceAccount = formData.get('sourceAccount');
          
          if ((sourceAccount === 'courant' && amount > 2.00) || 
              (sourceAccount === 'pro' && amount > 5.00)) {
            this.showErrorMessage('Virement refusé : Solde insuffisant');
          } else {
            this.showSuccessMessage('Virement effectué avec succès !');
            this.addTransactionToHistory(formData);
          }
          
          this.closeTransferModal();
        }, 2000);
      }

      validateTransferForm(form) {
        const requiredFields = form.querySelectorAll('[required]');
        let isValid = true;

        requiredFields.forEach(field => {
          if (!field.value.trim()) {
            field.classList.add('border-red-500');
            isValid = false;
          } else {
            field.classList.remove('border-red-500');
          }
        });

        return isValid;
      }

      showLoading() {
        this.state.isLoading = true;
        const button = document.querySelector('#transferForm button[type="submit"]');
        button.innerHTML = `
          <svg class="animate-spin w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Vérification en cours...
        `;
        button.disabled = true;
      }

      hideLoading() {
        this.state.isLoading = false;
        const button = document.querySelector('#transferForm button[type="submit"]');
        button.innerHTML = `
          <span class="flex items-center justify-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
            </svg>
            Envoyer le virement
          </span>
        `;
        button.disabled = false;
      }

      showSuccessMessage(message) {
        this.showToast(message, 'success');
      }

      showErrorMessage(message) {
        this.showToast(message, 'error');
      }

      showToast(message, type) {
        const toast = document.createElement('div');
        let bgColor = 'bg-blue-500';
        if (type === 'success') bgColor = 'bg-green-500';
        if (type === 'error') bgColor = 'bg-red-500';
        
        toast.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-slide-up`;
        toast.textContent = message;
        
        document.body.appendChild(toast);
        
        setTimeout(() => {
          toast.remove();
        }, 4000);
      }

      addTransactionToHistory(formData) {
        const transactionsList = document.getElementById('transactionsList');
        const newTransaction = document.createElement('div');
        const today = new Date().toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' });
        const amount = formData.get('amount');
        const beneficiary = document.getElementById('beneficiary').selectedOptions[0].text;
        
        newTransaction.className = 'transaction-item animate-bounce-subtle';
        newTransaction.innerHTML = `
          <div class="transaction-date">${today}</div>
          <div class="transaction-desc">
            <div>
              <div class="font-medium">Virement envoyé</div>
              <div class="text-xs text-ca-gray-500">${beneficiary}</div>
            </div>
          </div>
          <div class="transaction-amount amount-negative">-${amount} €</div>
        `;
        
        transactionsList.insertBefore(newTransaction, transactionsList.firstChild);
      }
    }

    // Initialize the application
    const app = new BankingApp();

    // Global functions for backwards compatibility
    function toggleCreditCard() { app.toggleCreditCard(); }
    function handleCardKeydown(event) { 
      if (event.key === 'Enter' || event.key === ' ') {
        event.preventDefault();
        app.toggleCreditCard();
      }
    }
    function toggleSettingsDropdown() { app.toggleSettingsDropdown(); }
    function openTransferModal(accountName, iban, balance) { app.openTransferModal(accountName, iban, balance); }
    function closeTransferModal() { app.closeTransferModal(); }
    function showBlockedAccountInfo() { app.showBlockedAccountInfo(); }
    function closeBlockedModal() { app.closeBlockedModal(); }
    function confirmLogout() { app.confirmLogout(); }
    function closeLogoutModal() { app.closeLogoutModal(); }
    function performLogout() { app.performLogout(); }
    function handleTransferSubmit(event) { app.handleTransferSubmit(event); }
    function updateBeneficiaryIban() { app.updateBeneficiaryIban(); }
    function formatIban(input) { app.formatIban(input); }
    function validateAmount(input) { app.validateAmount(input); }

    // Settings and navigation functions
    function showProfile() { 
      app.closeSettingsDropdown();
      app.showToast('Profil utilisateur - Fonctionnalité à venir', 'info');
    }
    function showNotifications() { 
      app.closeSettingsDropdown();
      app.showToast('Centre de notifications - Fonctionnalité à venir', 'info');
    }
    function showSecurity() { 
      app.closeSettingsDropdown();
      app.showToast('Paramètres de sécurité - Fonctionnalité à venir', 'info');
    }
    function showHelp() { 
      app.closeSettingsDropdown();
      app.showToast('Aide et support - Fonctionnalité à venir', 'info');
    }
    function switchToHome() { 
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      event.target.closest('.nav-item').classList.add('active');
    }
    function quickTransfer() { app.openTransferModal('', '', 0); }
    function showCards() { 
      app.showToast('Gestion des cartes - Fonctionnalité à venir', 'info');
    }
    function showTransactionDetail(id) {
      app.showToast('Détails de la transaction - Fonctionnalité à venir', 'info');
    }
    function callAdvisor() {
      app.showToast('Appel vers votre conseiller...', 'info');
      app.closeBlockedModal();
    }
  </script>
</body>

</html>
